# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

LeoeditV2 is a lightweight multi-tab code editor desktop application. The UI strings are partially in German (e.g., "Unbenannt.txt", "Bereit", "Geändert"). The author is Leo Träxler / Franz Träxler.

## Tech Stack

- **Backend**: Go 1.23 with Wails v2.11.0 (desktop app framework)
- **Frontend**: Vanilla JavaScript (no framework), CodeMirror 6, Vite 7
- **Platforms**: Linux (primary), macOS, Windows

## Build & Run Commands

```bash
# Development (hot reload for frontend + Go recompilation)
wails dev

# Production build (outputs to build/bin/)
wails build

# Frontend only (from frontend/ directory)
cd frontend && npm install
cd frontend && npm run dev      # Vite dev server
cd frontend && npm run build    # Build to dist/
```

There are no tests or linters configured.

## Architecture

### Go Backend (`main.go`, `app.go`)

Minimal — the Go side handles Wails app initialization (window size 1024x768, dark background, drag-and-drop enabled, Linux WebKit context menu). The `App` struct currently only stores the Wails context. File operations (`OpenFile`, `SaveFile`, `SaveFileAs`) are called from the frontend via `window.go.main.App.*` but are **not yet implemented** in the Go backend. The frontend has web fallbacks (FileReader API for open, Blob download for save).

### Frontend (`frontend/src/`)

All UI is built with vanilla JS — no framework, no components library. The DOM is constructed programmatically in JavaScript (not from HTML templates).

Key classes and their relationships:

- **`main.js`** — Entry point. Creates the `Menu` and `TabView`, wires keyboard shortcuts and menu actions to file/edit operations. Owns the Wails bridge calls (`window.go.main.App.*`) and web fallback logic. Runs a 1-second `setInterval` to update menu state.
- **`TabView`** (`tabview.js`) — Manages the tab bar and editor lifecycle. Holds a `tabs[]` array of `Tab` objects and an `editors` Map (`tabId → CodeEditor`). Creates/destroys CodeMirror instances on demand. Max 20 tabs.
- **`Tab`** (`tab.js`) — Plain data model: `id`, `title`, `content`, `type`, `isActive`, `isModified`, `path`. `getDisplayTitle()` appends `*` for modified files.
- **`CodeEditor`** (`editor.js`) — Wraps CodeMirror 6 `EditorView`. Creates the editor with `basicSetup`, a language extension, and `oneDark` theme. Notifies TabView of content changes via callback. Language switching destroys and reinitializes the entire editor.
- **`Menu`** (`lib/menu.js`) — Hierarchical menu bar (File, Edit, View, About) with submenu rendering, enable/disable per item, keyboard shortcut display, and SVG icons.
- **`constants.js`** — App metadata (name, version 3.3.0.0, author, default tab name "Unbenannt.txt").
- **`utils.js`** — UUID generation utility.

### Wails Bindings (`frontend/wailsjs/`)

Auto-generated by Wails. The frontend calls Go methods via `window.go.main.App.*` and Wails runtime via `window.runtime.*` (e.g., `Quit()`, `EventsEmit()`).

### Frontend Assets

- CSS files in `src/assets/css/`: `app.css` (global layout), `menu.css` (menu bar), `tabs.css` (tab headers + editor container)
- Dark color scheme: menubar `#2d3748`, tab header `#252526`, accent `#007acc`
- Nunito font bundled in `src/assets/fonts/`

## Key Patterns

- File type detection maps extensions to CodeMirror language modes (JS/TS/JSX/TSX → javascript, HTML/HTM → html, CSS, JSON, Python, Go, Java, C/C++ → cpp, Markdown, Text). Defined in `getFileType()` in `main.js` and `getLanguageExtension()` in `editor.js` — these are **separate mappings** that must be kept in sync.
- The `editors` Map in TabView preserves CodeMirror instances when switching tabs (hidden via `display:none`) rather than destroying/recreating them.
- Menu item IDs follow the pattern `menu-<action>` (e.g., `menu-new`, `menu-save`, `menu-close-file`). Menu handlers are passed as an options object keyed by these IDs.
- Embedded assets use Go's `//go:embed` for `build/appicon.png` and `frontend/dist`.
